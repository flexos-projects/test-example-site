---
import type { AstroBuiltinAttributes } from 'astro';

interface Props extends AstroBuiltinAttributes<'header'> {
  currentPath: string;
}

const { currentPath, ...attrs } = Astro.props;

const navLinks = [
  { name: 'Astro', href: '/astro' },
  { name: 'Tailwind', href: '/tailwind' },
  { name: 'Components', href: '/components' },
];
---

<header
  class="fixed top-0 left-0 w-full z-50 bg-[#ffffff] shadow-md py-4 sm:py-5"
  aria-label="Main Navigation"
  {...attrs}
>
  <div class="container mx-auto px-4 flex items-center justify-between">
    <!-- Site Title / Logo -->
    <a href="/" class="flex items-center space-x-2 group" aria-label="Homepage">
      <span class="text-2xl font-bold font-['IBM_Plex_Sans'] text-[#000000] group-hover:text-[#81A4BB] transition-colors duration-200">
        My Site
      </span>
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex space-x-8 font-['Inter'] text-lg">
      {navLinks.map((link) => (
        <a
          href={link.href}
          class:list={[
            "text-[#333333] hover:text-[#81A4BB] transition-colors duration-200 relative py-1",
            { "font-bold text-[#81A4BB] after:absolute after:bottom-[-4px] after:left-0 after:w-full after:h-[2px] after:bg-[#A2D9D0]": currentPath === link.href }
          ]}
          aria-current={currentPath === link.href ? 'page' : undefined}
        >
          {link.name}
        </a>
      ))}
    </nav>

    <!-- Mobile Menu Toggle (Hamburger) -->
    <div class="md:hidden flex items-center">
      <button
        id="mobile-menu-button"
        class="text-[#000000] hover:text-[#81A4BB] focus:outline-none focus:ring-2 focus:ring-[#81A4BB] rounded-sm p-2 transition-colors duration-200"
        aria-label="Open main menu"
        aria-expanded="false"
      >
        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Menu (Drawer) -->
  <nav
    id="mobile-menu"
    class="md:hidden fixed top-0 left-0 w-full h-full bg-[#ffffff] transform -translate-x-full transition-transform duration-300 ease-in-out z-40 p-6 flex flex-col space-y-6 font-['Inter'] text-xl overflow-y-auto"
    aria-label="Mobile Navigation"
  >
    <div class="flex justify-end">
      <button
        id="close-mobile-menu-button"
        class="text-[#000000] hover:text-[#81A4BB] focus:outline-none focus:ring-2 focus:ring-[#81A4BB] rounded-sm p-2 transition-colors duration-200"
        aria-label="Close main menu"
      >
        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
    {navLinks.map((link) => (
      <a
        href={link.href}
        class:list={[
          "text-[#333333] hover:text-[#81A4BB] transition-colors duration-200 py-2 block",
          { "font-bold text-[#81A4BB] border-l-4 border-[#A2D9D0] pl-4": currentPath === link.href }
        ]}
        aria-current={currentPath === link.href ? 'page' : undefined}
      >
        {link.name}
      </a>
    ))}
  </nav>
</header>

<script is:inline>
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const closeMobileMenuButton = document.getElementById('close-mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuButton && mobileMenu && closeMobileMenuButton) {
    mobileMenuButton.addEventListener('click', () => {
      const isExpanded = mobileMenu.classList.toggle('-translate-x-full');
      mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
      document.body.style.overflow = isExpanded ? '' : 'hidden'; // Prevent scrolling when menu is open
    });

    closeMobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.add('-translate-x-full');
      mobileMenuButton.setAttribute('aria-expanded', 'false');
      document.body.style.overflow = '';
    });

    // Close menu when a link is clicked
    mobileMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.add('-translate-x-full');
        mobileMenuButton.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      });
    });
  }
</script>